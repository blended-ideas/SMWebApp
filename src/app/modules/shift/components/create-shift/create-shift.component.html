<div class="app-page-title align-items-center">
  <h3>Create Shift</h3>
  <div class="ml-auto">
    <ng-container *ngIf="!isCreating">
      <button (click)="cancel()" class="btn btn-sm btn-danger">
        <fa-icon [icon]="faTimes"></fa-icon>
        Cancel
      </button>
      <button class="btn btn-sm btn-primary ml-2" form="createShiftForm" type="submit">
        <fa-icon [icon]="faPlusSquare"></fa-icon>
        Create
      </button>
    </ng-container>
    <fa-icon *ngIf="isCreating" [icon]="faSpinner" [spin]="true" size="2x"></fa-icon>
  </div>
</div>

<!--
<div class="row">
  <div class="col-12 col-md-6">
    <div class="card">
      <div class="card-header">
        <h6>
          Shift Details
          <fa-icon [icon]="faClipBoard"></fa-icon>
        </h6>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-12 col-md-6">
            Shift Date:
            <div>
              <div class="input-group input-group-sm">
                <input #start_date="ngbDatepicker" (click)="start_date.open()" [(ngModel)]="selectedShiftTiming"
                       [maxDate]="maxDate" [readonly]="true" class="form-control form-control-sm"
                       formControlName="start_date" id="start_date" ngbDatepicker title="Shift Start Date" type="text">
                <div class="input-group-append">
                  <button (click)="start_date.toggle()" class="btn btn-outline-secondary" type="button">
                    <fa-icon [icon]="faCalender"></fa-icon>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 col-md-6">
            Select Shift:
            <select (ngModelChange)="shiftChange($event)" [(ngModel)]="selectedShiftTiming"
                    [ngModelOptions]="{standalone: true}" class="custom-select">
              <option *ngFor="let shift of SHIFT_TIMINGS" [ngValue]="shift">
                {{shift.display}}
              </option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-12 col-md-6">
    <div class="card">
      <div class="card-header">
        <h6>Products Sold</h6>
      </div>
      <div class="card-body">
        <div class="mb-4">
          <ng-select #selectComponent (change)="addProduct($event)" [items]="products | async"
                     [loading]="productsLoading" [typeahead]="productSearchString" class="form-control-sm px-0"
                     id="contact" placeholder="Search for products">
            <ng-template let-item="item" ng-option-tmp>
              {{item.name}} | {{item.category}}
            </ng-template>

            <ng-template let-item="item" ng-label-tmp> {{item.name}} | {{item.category}}
            </ng-template>
          </ng-select>
        </div>

        <form (validSubmit)="createShift()" *ngIf="shiftForm" [formGroup]="shiftForm" class="mx-4" id="createShiftForm">
          <div *ngFor="let productCtrl of getProductControls();let i=index" formArrayName="entries">
            <ng-container [formGroupName]="i">
              <div class="d-flex justify-content-between">
                <div>{{this.shiftForm.getRawValue()['entries'][i]['product'].name}} </div>
                <fa-icon [icon]="faTimes"></fa-icon>
              </div>
              <div class="col-8 row form-group">
                <input class="form-control form-control-sm col-6" formControlName="quantity" id="entries{{i}}"
                       title="Quantity" type="number">
              </div>
            </ng-container>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
-->


<div class="px-0 px-md-4">
  <div class="row">
    <div class="col-12 col-md-6">
      <div class="card">
        <div class="card-header">
          <h6>
            Shift Details
            <fa-icon [icon]="faClipBoard"></fa-icon>
          </h6>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-12 col-md-6">
              Shift Date:
              <div class="input-group input-group-sm">
                <input #start_date="ngbDatepicker" (click)="start_date.open()"
                       (ngModelChange)="shiftChange($event, selectedShiftTiming)"
                       [(ngModel)]="shiftDate"
                       [maxDate]="maxDate" [readonly]="true" class="form-control form-control-sm"
                       id="start_date" ngbDatepicker title="Shift Start Date" type="text">
                <div class="input-group-append">
                  <button (click)="start_date.toggle()" class="btn btn-outline-secondary" type="button">
                    <fa-icon [icon]="faCalender"></fa-icon>
                  </button>
                </div>
              </div>
            </div>

            <div class="col-12 col-md-6">
              Select Shift:
              <select (ngModelChange)="shiftChange(shiftDate, $event)" [(ngModel)]="selectedShiftTiming"
                      class="custom-select custom-select-sm" title="Shift Timing">
                <option *ngFor="let shift of SHIFT_TIMINGS" [ngValue]="shift">
                  {{shift.display}} ({{shift.display2}})
                </option>
              </select>
            </div>

            <div class="col-12 mt-4">
              <div> Shift Start: {{shiftView.startTime|date: 'dd/MM/yyyy hh:mm a'}} </div>
              <div> Shift End: {{shiftView.endTime|date: 'dd/MM/yyyy hh:mm a'}} </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-6">
      <div class="card">
        <div class="card-header">
          <h6>Products Sold</h6>
        </div>
        <div class="card-body">
          <div class="mb-4">
            <ng-select #selectComponent (change)="addProduct($event)" [items]="products | async"
                       [loading]="productsLoading" [typeahead]="productSearchString" class="form-control-sm px-0"
                       id="contact" placeholder="Search for products">
              <ng-template let-item="item" ng-option-tmp>
                {{item.name}} | {{item.category}}
              </ng-template>

              <ng-template let-item="item" ng-label-tmp> {{item.name}} | {{item.category}}
              </ng-template>
            </ng-select>
          </div>

          <form (validSubmit)="createShift()" *ngIf="shiftForm" [formGroup]="shiftForm" class="border-top pt-2"
                id="createShiftForm">
            <div *ngFor="let productCtrl of getProductControls();let i=index" formArrayName="entries">
              <ng-container [formGroupName]="i">
                <div class="d-flex justify-content-between">
                  <div>{{this.shiftForm.getRawValue()['entries'][i]['product'].name}} </div>
                  <fa-icon [icon]="faTimes"></fa-icon>
                </div>
                <div class="col-8 row form-group">
                  <input class="form-control form-control-sm col-6" formControlName="quantity" id="entries{{i}}"
                         title="Quantity" type="number">
                </div>
              </ng-container>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
